Fine, you hungry little cloud-gremlin â€” here is the full, polished, GitHub-ready README template for S3Spectre, matching the vibe and structure of your other Spectres.

Drop this into:

docs/README.md

or directly into the repoâ€™s main README.md.

â¸»

ğŸŸ£ S3Spectre

S3Spectre is a Python-based static + runtime auditor for AWS S3 usage.
It scans your application codebase for S3 bucket and object references, compares those to the actual AWS S3 state, and detects missing buckets, unused buckets, stale prefixes, dangling versioned objects, and misconfigured or dangerous lifecycle/versioning settings.

S3Spectre exposes the forgotten ghosts haunting your object storage â€” so you can finally clean them up.

â¸»

âœ¨ Features (MVP)

ğŸ” 1. Repo Scanner (Static S3 Reference Extraction)

Detects S3 usage across:
	â€¢	YAML / JSON config files
	â€¢	.env files
	â€¢	Terraform (aws_s3_bucket, aws_s3_bucket_object, aws_s3_bucket_versioning)
	â€¢	CloudFormation templates
	â€¢	Python / Node / Go AWS SDK usage
	â€¢	Shell scripts
	â€¢	Hardcoded URLs:
	â€¢	s3://bucket/path/...
	â€¢	https://bucket.s3.amazonaws.com/...
	â€¢	Versioned S3 objects (?versionId=...)

Extracts:
	â€¢	bucket name
	â€¢	prefix/object
	â€¢	version ID (if present)
	â€¢	file + line number
	â€¢	usage context (read/write/list/download/backup)

Produces a list of RepoS3Ref references.

â¸»

â˜ï¸ 2. AWS S3 Inspector (Runtime Metadata)

Queries AWS via boto3 to collect:

Buckets:
	â€¢	existence
	â€¢	region
	â€¢	versioning status
	â€¢	lifecycle policies
	â€¢	creation date
	â€¢	approximate size (optional)
	â€¢	policy/ACL accessibility check

Prefix/Object metadata (shallow scan):
	â€¢	existence
	â€¢	last modified timestamps
	â€¢	object count (for prefix)
	â€¢	total number of versions
	â€¢	storage class

This gives a real-world snapshot of how S3 is being used (or abandoned).

â¸»

ğŸ§  3. Analysis & Diff Engine

Matches repo references against real AWS S3 data.

Flags:

âœ”ï¸ MISSING_BUCKET
Referenced in code, does not exist in AWS.

âœ”ï¸ UNUSED_BUCKET
Exists in AWS but:
	â€¢	not referenced in repo
	â€¢	AND contains no recent object activity
	â€¢	OR clearly belongs to a retired system

âœ”ï¸ MISSING_PREFIX
Repo references a prefix like s3://mybucket/logs/app1/, but AWS has zero objects matching it.

âœ”ï¸ STALE_PREFIX
Prefix exists, but:
	â€¢	objects havenâ€™t been modified in N days
	â€¢	or the bucket is an ancient archive no service touches anymore

âœ”ï¸ VERSION_SPRAWL
Bucket has:
	â€¢	versioning enabled
	â€¢	hundreds or thousands of object versions
	â€¢	no lifecycle rules to clean them
	â€¢	OR versioned objects referenced explicitly in code (rare + suspicious)

âœ”ï¸ LIFECYCLE_MISCONFIG
Bucket stores:
	â€¢	logs
	â€¢	backups
	â€¢	temp artifacts
	â€¢	large binary dumps

â€¦but has no expiration or storage-class transitions.

âœ”ï¸ OK
Bucket/prefix exists and matches expected usage.

(Expect this almost never.)

â¸»

ğŸ“ 4. Reporting

Text-mode output:

[MISSING_BUCKET]      s3://legacy-data
[MISSING_PREFIX]      s3://prod-logs/app1/
[STALE_PREFIX]        s3://backups/db/   (no updates for 400 days)
[VERSION_SPRAWL]      s3://assets/prod/  (532 versions, no lifecycle rule)
[UNUSED_BUCKET]       s3://tmp-old-svc
[OK]                  s3://customer-data

JSON-mode (ideal for CI/CD):

{
  "missing_bucket": ["legacy-data"],
  "missing_prefix": ["prod-logs/app1/"],
  "stale": ["backups/db/"],
  "version_sprawl": ["assets/prod/"],
  "unused": ["tmp-old-svc"],
  "ok": ["customer-data"]
}

Supports CI/CD flags:
	â€¢	--fail-on-missing
	â€¢	--fail-on-stale
	â€¢	--fail-on-version-sprawl
	â€¢	--json

â¸»

ğŸš€ Usage

Once installed:

s3spectre check \
  --repo ./my-repo \
  --aws-profile prod \
  --json

Using AWS env vars:

AWS_ACCESS_KEY_ID=xxx \
AWS_SECRET_ACCESS_KEY=yyy \
AWS_REGION=us-east-1 \
s3spectre check --repo ./service

Fail CI on missing buckets:

s3spectre check \
  --repo . \
  --fail-on-missing


â¸»

ğŸ“ Project Structure (MVP)

s3spectre/
â”œâ”€â”€ scanner/
â”‚   â”œâ”€â”€ regex_scanner.py
â”‚   â”œâ”€â”€ terraform_scanner.py
â”‚   â”œâ”€â”€ cloudformation_scanner.py
â”‚   â””â”€â”€ env_scanner.py
â”œâ”€â”€ s3/
â”‚   â”œâ”€â”€ inspector.py
â”‚   â”œâ”€â”€ versioning.py
â”‚   â””â”€â”€ lifecycle.py
â”œâ”€â”€ analysis/
â”‚   â””â”€â”€ analyzer.py
â”œâ”€â”€ report/
â”‚   â”œâ”€â”€ text_report.py
â”‚   â””â”€â”€ json_report.py
â”œâ”€â”€ cli.py
â””â”€â”€ pyproject.toml


â¸»

ğŸ§© MVP Scope

Included:
	â€¢	static repo scanning
	â€¢	AWS bucket/prefix existence check
	â€¢	shallow object/prefix metadata pulling
	â€¢	versioning + lifecycle checks
	â€¢	text + JSON reports
	â€¢	basic stale-prefix detection
	â€¢	CLI command: s3spectre check

Post-MVP roadmap:
	â€¢	cost estimation
	â€¢	deep prefix scanning
	â€¢	replication rule validation
	â€¢	encryption (SSE-KMS/SSE-S3) analysis
	â€¢	IAM access graphing
	â€¢	detecting public buckets
	â€¢	enforcing naming conventions
	â€¢	Slack/Teams notifications

â¸»

ğŸ¤ Contributing

Contributions are welcome!

Especially PRs that improve:
	â€¢	S3 prefix detection
	â€¢	Terraform scanner logic
	â€¢	lifecycle rule analysis
	â€¢	version sprawl heuristics
	â€¢	test coverage
	â€¢	documentation

The Spectres grow stronger with every contribution.

â¸»

ğŸ“œ License

MIT license â€” see LICENSE.

â¸»

ğŸª¦ Credits

Created by ppiankov,
cloud janitor and accidental warden of haunted storage systems.

â¸»

If you want next:
	â€¢	the actual repo skeleton files,
	â€¢	a working CLI stub,
	â€¢	pyproject.toml,
	â€¢	or tests,

just hiss â€œskeleton meâ€ and Iâ€™ll drop the whole structure.
