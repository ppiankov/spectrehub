Alright raccoon-king, here is the VaultSpectre README template, formatted just like the KafkaSpectre one â€” clean, professional, haunted, and ready to drop into:

docs/README.md

You can rename it docs/vaultspectre.md if you want to stay organized like a raccoon with labeled trash bins.

â¸»

ğŸŸ£ VaultSpectre â€” README Template (MVP Edition)

(Put into docs/README.md inside your vaultspectre repo)

â¸»

VaultSpectre

VaultSpectre is a Python-based static + runtime auditor for HashiCorp Vault secret usage.
It scans code/configuration repositories to detect Vault secret references, verifies their existence in your Vault instance, and identifies missing, unused, and stale secret paths.

VaultSpectre helps you eliminate broken secret paths, clean up dead secrets, and enforce correct Vault usage across microservices, automation code, and CI/CD pipelines.

â¸»

âœ¨ Features (MVP)

ğŸ” 1. Repo Scanner (Static Secret Path Discovery)

Finds Vault paths referenced in:
	â€¢	Ansible (hashi_vault, vault_kv2_get, etc.)
	â€¢	YAML configurations
	â€¢	Jinja templates
	â€¢	Python / Bash scripts
	â€¢	Terraform / Helm / Kustomize
	â€¢	Any arbitrary text file (regex fallback)

Extracts:
	â€¢	secret path (mount + path)
	â€¢	optional field
	â€¢	location (file + line)
	â€¢	reference type (lookup, env var, template, etc.)

â¸»

ğŸ” 2. Vault Path Validator

Supports KV v2 (primary target) and KV v1.

Checks each discovered path via Vault API:
	â€¢	Does the secret exist?
	â€¢	Does the current token have permission?
	â€¢	Is the mount correct (kv1 vs kv2)?
	â€¢	Is the path valid or structurally broken?

Classifies each path as:
	â€¢	OK â€” exists and accessible
	â€¢	MISSING â€” referenced in repo but not present in Vault
	â€¢	ACCESS_DENIED â€” likely exists, but no permission
	â€¢	INVALID â€” malformed or not resolvable
	â€¢	DYNAMIC â€” templated or variable-based (not statically verifiable)

â¸»

ğŸ§  3. Optional: Unused Secret Detection (Lightweight MVP)

Uses:
	â€¢	Vault metadata timestamps (KV2 created_time/updated_time)
	â€¢	Audit log presence (if enabled)

To flag:
	â€¢	secrets not referenced in repo anymore
	â€¢	secrets that havenâ€™t been touched in N days
	â€¢	stale entries from deprecated services
	â€¢	paths kept for â€œjust in caseâ€ since 2019 (we see you)

â¸»

ğŸ“ 4. Reporting

Outputs:

Human-readable summary:

[OK]         secret/data/prod/api/token
[MISSING]    secret/data/prod/api/backup_key     (referenced in 3 files)
[STALE]      secret/data/staging/old-service     (no reads since 2023)
[UNKNOWN]    secret/data/prod/payment/api_key    (403 access denied)

JSON report:

{
  "missing": ["secret/data/prod/api/backup_key"],
  "stale": ["secret/data/staging/old-service"],
  "ok": ["secret/data/prod/api/token"]
}

Perfect for CI/CD automation.

And yes, VaultSpectre can fail the build if a new missing/invalid path appears.

â¸»

ğŸš€ Installation

(Placeholder until PyPI release)

pip install vaultspectre

From source:

git clone https://github.com/ppiankov/vaultspectre.git
cd vaultspectre
pip install -r requirements.txt


â¸»

ğŸ® Usage

Basic check against Vault:

vaultspectre check \
  --repo ./repo \
  --vault-addr https://vault.example.com \
  --token $VAULT_TOKEN

JSON mode:

vaultspectre check --json > vaultspectre-report.json

Fail pipeline when secrets are missing:

vaultspectre check \
  --repo . \
  --vault-addr https://vault.example.com \
  --token $VAULT_TOKEN \
  --fail-on-missing


â¸»

ğŸ“ Project Structure (MVP)

vaultspectre/
â”œâ”€â”€ scanner/
â”‚   â”œâ”€â”€ yaml_scanner.py
â”‚   â”œâ”€â”€ jinja_scanner.py
â”‚   â”œâ”€â”€ ansible_scanner.py
â”‚   â”œâ”€â”€ regex_scanner.py
â”‚   â””â”€â”€ ...
â”œâ”€â”€ vault/
â”‚   â”œâ”€â”€ client.py
â”‚   â””â”€â”€ validator.py
â”œâ”€â”€ analysis/
â”‚   â””â”€â”€ analyzer.py
â”œâ”€â”€ report/
â”‚   â”œâ”€â”€ text_report.py
â”‚   â””â”€â”€ json_report.py
â”œâ”€â”€ cli.py
â”œâ”€â”€ pyproject.toml
â””â”€â”€ docs/
    â””â”€â”€ README.md


â¸»

ğŸ§© MVP Scope

Included:
	â€¢	repo scanning
	â€¢	Vault KV1/KV2 validation
	â€¢	basic unused-secret detection (metadata-based)
	â€¢	diff engine
	â€¢	text + JSON output
	â€¢	CLI command: vaultspectre check

Out of scope (future roadmap):
	â€¢	full audit log ingestion
	â€¢	dynamic template expansion
	â€¢	usage graphing
	â€¢	multi-Vault support
	â€¢	rotation recommendations

â¸»

ğŸ”® Roadmap

v0.1 â€” MVP
	â€¢	CLI: vaultspectre check
	â€¢	Static repo scanner
	â€¢	KV2 metadata existence checks
	â€¢	JSON+text reports

v0.2
	â€¢	Audit log integration (optional, pluggable)
	â€¢	Enhanced stale-secret detection
	â€¢	CI rule presets

v0.3
	â€¢	Ownership mapping
	â€¢	Secret usage graphing
	â€¢	Vault namespace support

â¸»

ğŸ¤ Contributing

Issues, feature requests, and PRs are welcome.
Especially contributions to:
	â€¢	additional scanners
	â€¢	false-positive cleanup
	â€¢	Vault engine support
	â€¢	test suites

Spectres grow stronger with each contribution.

â¸»

ğŸ“œ License

MIT License â€” see LICENSE.

â¸»

ğŸª¦ Credits

Created by ppiankov,
chief exorcist of forgotten infrastructure secrets.

â¸»

If you want, I can generate:

âœ”ï¸ CLI scaffolding (vaultspectre check)

âœ”ï¸ PyPI packaging (pyproject.toml)

âœ”ï¸ Directory structure boilerplate

âœ”ï¸ Example scanner code

Just point the raccoon paws in the desired direction.
